% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/functions.R
\name{MC_propagate}
\alias{MC_propagate}
\title{Propagates uncertainty in tree biomass or carbon estimates using Monte Carlo simulation.
This function can be applied to any allometric function, including Bunce, WCC, Chave, or user-defined functions.
Users provide the function, input means and standard deviations (measurement or parameter uncertainty),
and optionally a correlation matrix between inputs.}
\usage{
MC_propagate(fn, inputs, N = 5000, corr_matrix = NULL, extra_args = list())
}
\arguments{
\item{fn}{A function that returns biomass (or carbon) given input variables.}

\item{inputs}{A named list of inputs. Each element must be a list with components:
\itemize{
\item mean: numeric value or vector
\item sd: standard deviation representing uncertainty
Example: list(dbh = list(mean=30, sd=0.01\emph{30), a = list(mean=1.2, sd=0.025}1.2))
}}

\item{N}{Integer. Number of Monte Carlo draws. Default 5000.}

\item{corr_matrix}{Optional correlation matrix between input variables for multivariate sampling.
Must be consistent with the order of variables in \code{inputs}.}

\item{extra_args}{Optional list of additional fixed arguments to pass to \code{f}.}
}
\value{
A list containing:
\itemize{
\item mean: mean of simulated biomass/carbon
\item sd: standard deviation
\item ci: 2.5\% and 97.5\% quantiles
\item sim_values: vector of all simulated values
}
}
\description{
Propagates uncertainty in tree biomass or carbon estimates using Monte Carlo simulation.
This function can be applied to any allometric function, including Bunce, WCC, Chave, or user-defined functions.
Users provide the function, input means and standard deviations (measurement or parameter uncertainty),
and optionally a correlation matrix between inputs.
}
\examples{
Bunce_fun <- function(dbh, a, b){ exp(a + b * log(pi * dbh)) }
inputs <- list(dbh = list(mean=30, sd=0.01*30), a=list(mean=1.2, sd=0.025*1.2),
               b=list(mean=0.8, sd=0.025*0.8))
MC_result <- MC_propagate(f = Bunce_fun, inputs = inputs, N = 5000)
MC_result$mean
MC_result$sd
MC_result$ci
}
\references{
Réjou-Méchain M., et al. (2017). BIOMASS: an R package for estimating above-ground biomass and its uncertainty.
Chave J., et al. (2014). Improved allometric models to estimate the above-ground biomass of tropical trees.
Efron B. & Tibshirani R. (1993). An Introduction to the Bootstrap.
}
