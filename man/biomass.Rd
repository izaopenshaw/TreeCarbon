% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Alt_Allometries.R
\name{BIOMASS}
\alias{BIOMASS}
\alias{biomass}
\title{Estimate Tree Biomass using BIOMASS R package}
\usage{
BIOMASS(
  dbh,
  height = NULL,
  genus,
  species,
  coords,
  region = "World",
  output.all = TRUE,
  HD_method = "log2",
  rich_output = FALSE,
  uncertainty = FALSE,
  n_mc = 1000,
  Dpropag = "chave2004",
  errH = NULL,
  wd = NULL,
  wd_sd = NULL
)
}
\arguments{
\item{dbh}{Diameter at breast height (cm)}

\item{height}{height of tree in metres (if not specified will estimate height)}

\item{genus}{First part of species binomial}

\item{species}{Second part of species binomial}

\item{coords}{either a vector of coordinates of the site or a matrix of
coordinates for each tree of longitude and latitude}

\item{region}{of the World. See ?getWoodDensity for the list of regions}

\item{output.all}{if TRUE outputs all data from processing, else just outputs
carbon figures}

\item{HD_method}{If there are missing height variables, the function will
predict height using a height diameter model. This model is custom if there
are over 15 height measurements inputted, in which case you can choose a
model fit for this from, HD_method = c("log2","weibull","log1","exp","lin")
See BIOMASS::modelHD for more.}

\item{rich_output}{Logical. If TRUE, returns a rich result object with full
metadata including: value, method, citation, assumptions, validity_warning,
flags, region, and source type. Default FALSE for backwards compatibility.}

\item{uncertainty}{Logical. If TRUE, runs Monte Carlo uncertainty propagation
using \code{BIOMASS::AGBmonteCarlo}. This propagates errors from:
\itemize{
\item DBH measurement error (via Dpropag)
\item Wood density uncertainty (from species/genus matching)
\item Height estimation error (if heights are predicted)
\item Allometric model error
}
Returns SD, CV, and 5-95\% credible intervals. Default FALSE.}

\item{n_mc}{Number of Monte Carlo iterations for uncertainty estimation.
Default 1000. Higher values give more stable estimates but take longer.
Recommended: 1000 for quick checks, 10000 for final results.}

\item{Dpropag}{Method for propagating DBH measurement error. Options:
\itemize{
\item "chave2004" (default): Uses error model from Chave et al. 2004
where SD = 0.0062*DBH + 0.0904
\item A numeric value: Fixed relative error applied to all trees
\item A numeric vector: Per-tree absolute measurement errors
}}

\item{errH}{Height measurement error. Required when \code{uncertainty = TRUE}
and heights are provided directly (not estimated). Options:
\itemize{
\item NULL (default): If heights are estimated, error is propagated from
the height-diameter model. If heights are provided directly, errH is
set to 0 (no height error propagation).
\item A numeric value: Fixed relative error (e.g., 0.05 for 5\\%)
applied to all trees as SD = errH * height.
\item A numeric vector: Per-tree absolute height errors (in metres).
}}

\item{wd}{Wood density (g/cm3). Optional. If NULL (default), wood density
is retrieved from the Global Wood Density Database via
\code{BIOMASS::getWoodDensity()}. If provided, must be a numeric value or
vector matching the length of \code{dbh}.}

\item{wd_sd}{Standard deviation of wood density. Optional. If NULL and
\code{wd} is provided, a default SD of 10\\% of wd is used. If \code{wd}
is NULL, this is retrieved from the database.}
}
\value{
If \code{rich_output = FALSE}: Above-ground Biomass in kg. If
output.all = FALSE, returns columns 'genus_corrected','species', 'Family',
'Latitude', 'Longitude', 'dbh', 'AGB_Biomass_kg'. If output.all = TRUE then
additionally returns columns 'Wood_Density', 'Wood_Density_sd', 'height_est',
'RSE'.

If \code{uncertainty = TRUE}, additional columns include:
\itemize{
\item AGB_mean_kg: Mean from Monte Carlo simulation
\item AGB_sd_kg: Standard deviation
\item AGB_CI_low_kg: 5th percentile (lower credible bound)
\item AGB_CI_high_kg: 95th percentile (upper credible bound)
\item AGB_median_kg: Median estimate
\item AGB_CV_pct: Coefficient of variation (\%)
}

If \code{rich_output = TRUE}: an \code{allometry_result} object with full
metadata including uncertainty estimates.
}
\description{
Using the BIOMASS package (Chave et al. pantropical equations)
to calculate above-ground biomass with optional Monte Carlo uncertainty
propagation.

When \code{rich_output = TRUE}, returns a comprehensive result object
including method metadata, assumptions, validity warnings, and uncertainty.

When \code{uncertainty = TRUE}, uses \code{BIOMASS::AGBmonteCarlo} to
propagate uncertainty from DBH measurement error, wood density uncertainty,
and height estimation error, providing credible intervals and CV.
}
\examples{

utils::install.packages("BIOMASS", dependencies = TRUE)

coords <- c(-0.088837, 51.071610)

# Basic usage
BIOMASS(12, 12, 'Quercus', 'robur', coords)

# With uncertainty estimation (default 5\% height error)
result <- BIOMASS(30, 15, 'Quercus', 'robur', coords,
                  uncertainty = TRUE, n_mc = 1000)
result[, c("AGB_Biomass_kg", "AGB_sd_kg", "AGB_CV_pct")]

# With specific height measurement error (10\% relative error)
result <- BIOMASS(30, 15, 'Quercus', 'robur', coords,
                  uncertainty = TRUE, n_mc = 1000, errH = 0.10)
result[, c("AGB_Biomass_kg", "AGB_sd_kg", "AGB_CV_pct")]

# Rich output with full metadata and uncertainty
result <- BIOMASS(30, 15, 'Quercus', 'robur', coords,
                  rich_output = TRUE, uncertainty = TRUE)
print(result)

}
\references{
Rejou-Mechain, M., Tanguy, A., Piponiot, C., Chave, J., & Herault, B. (2017).
BIOMASS: an R package for estimating above-ground biomass and its uncertainty
in tropical forests. Methods in Ecology and Evolution, 8(9), 1163-1167.
DOI: 10.1111/2041-210X.12753

Chave, J. et al. (2014). Improved allometric models to estimate the
aboveground biomass of tropical trees. Global Change Biology, 20, 3177-3190.
}
