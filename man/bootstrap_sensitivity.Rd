% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Uncertainty.R
\name{bootstrap_sensitivity}
\alias{bootstrap_sensitivity}
\title{Bootstrap Sensitivity Analysis with Measurement Uncertainty}
\usage{
bootstrap_sensitivity(
  data,
  methods = c("WCC", "BIOMASS", "allodb", "Bunce"),
  coords = NULL,
  type = "broadleaf",
  n_boot = 500,
  dbh_cv = 0.02,
  height_cv = 0.05,
  method = "IPCC2",
  biome = "temperate",
  seed = NULL,
  verbose = TRUE
)
}
\arguments{
\item{data}{A data frame with columns: dbh, height, genus, species.
Optionally: type, name.}

\item{methods}{Character vector of methods to compare. Default:
\code{c("WCC", "BIOMASS", "allodb", "Bunce")}}

\item{coords}{Coordinates for BIOMASS/allodb (longitude, latitude).}

\item{type}{Tree type: "broadleaf" or "conifer". Default "broadleaf".}

\item{n_boot}{Number of bootstrap iterations. Default 500.}

\item{dbh_cv}{Coefficient of variation for DBH measurement error (proportion).
Default 0.02 (2\\%).}

\item{height_cv}{Coefficient of variation for height measurement error (proportion).
Default 0.05 (5\\%).}

\item{method}{Carbon conversion method. Default "IPCC2".}

\item{biome}{Biome for carbon conversion. Default "temperate".}

\item{seed}{Random seed for reproducibility. Default NULL (no seed).}

\item{verbose}{Print progress messages. Default TRUE.}
}
\value{
A list of class "bootstrap_sensitivity" containing:
\itemize{
\item cv_observed: The observed CV from point estimates
\item cv_boot: Vector of bootstrapped CVs
\item cv_ci: 95 percent confidence interval on CV
\item cv_se: Standard error of CV
\item range_ratio_observed: The observed range ratio
\item range_ratio_boot: Vector of bootstrapped range ratios
\item range_ratio_ci: 95 percent confidence interval on range ratio
\item spread_pct_boot: Vector of bootstrapped spread percentages
\item spread_pct_ci: 95 percent confidence interval on spread percentage
\item n_boot: Number of bootstrap iterations completed
\item n_failed: Number of failed iterations
\item interpretation: Plain-language interpretation of results
}
}
\description{
Quantifies the uncertainty around sensitivity metrics (CV, range ratio) by
propagating measurement errors through all allometric methods via bootstrapping.

This answers the question: "Given my measurement uncertainty, how confident
am I in my conclusion about method sensitivity?"
}
\details{
\strong{Algorithm:}
For each bootstrap iteration:
\enumerate{
\item Perturb DBH using normally-distributed relative error
\item Perturb height using normally-distributed relative error
\item Run all allometric methods with perturbed inputs
\item Calculate between-method CV from the perturbed totals
\item Store the CV
}
Then compute confidence intervals on the distribution of CVs.

\strong{Interpretation:}
If the 95 percent CI on CV is narrow (around 5 percentage points),
your sensitivity conclusion is robust to measurement error. If wide
(more than 20 percentage points), measurement error significantly
affects your sensitivity assessment.

\strong{Computational Note:}
This function is computationally intensive. For 100 trees and 500
bootstrap iterations, it runs 2000 allometry calculations. Consider
using fewer iterations (n_boot = 100) for initial exploration.
}
\examples{
\dontrun{
# Basic usage
tree_data <- data.frame(
  dbh = c(30, 45, 60),
  height = c(15, 20, 25),
  genus = c("Quercus", "Fagus", "Fraxinus"),
  species = c("robur", "sylvatica", "excelsior")
)

result <- bootstrap_sensitivity(
  tree_data,
  coords = c(-0.29, 51.48),
  n_boot = 100,  # Use more for final analysis
  seed = 42
)

print(result)
plot(result)
}

}
\seealso{
\code{\link{sensitivity_analysis}} for point estimate sensitivity,
\code{\link{mc_uncertainty}} for single-method uncertainty
}
